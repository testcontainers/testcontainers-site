{{ define "pageScripts" }}
    {{ $style := resources.Get "/sass/modules.scss" | resources.ToCSS | resources.Minify | resources.Fingerprint }}
    <link rel="stylesheet" href="{{ $style.RelPermalink }}">

    {{ $guidesstyle := resources.Get "/sass/guides.scss" | resources.ToCSS | resources.Minify | resources.Fingerprint }}
    <link rel="stylesheet" href="{{ $guidesstyle.RelPermalink }}">

    {{ $script := resources.Get "/js/modules.js" | js.Build | resources.Minify }}
    <script src="{{ $script.RelPermalink }}" defer></script>
{{ end }}

{{ define "main" }}
  <main>
    <section class="modules-banner">
        <div class="container">
          <div class="content">
            <h1>{{ .Title }}</h1>
            {{ if .Description }}
              <div class="description">{{ .Description | markdownify }}</div>
            {{ end }}
            <div class="search">
              <input id="modules-search" type="text" placeholder="Search"/>
            </div>
          </div>
        </div>
    </section>
    <section class="modules-list">
      <div class="container">
        <div class="filter">
            <div class="status-filter">
              <div class="filter-field">
                  <input type="checkbox" id="status-official" name="status-official" class="sr-only"/>
                  <label for="status-official" class="checkbox">
                    <div class="checkbox-proxy">
                      <svg class="icon-external" width="10" height="10" viewBox="0 0 10 10">
                          <use href="#icon-check"></use>
                      </svg>
                    </div>
                    <span>Official Modules</span>
                  </label>
              </div>
            </div>
            <div class="language-filter">
              <h3>Languages</h3>
              {{ range .Site.Taxonomies.languages }}
                <div class="filter-field">
                    <input type="checkbox" id="language-{{ .Page.Params.slug }}" name="language-{{ .Page.Params.slug }}" class="sr-only"/>
                    <label for="language-{{ .Page.Params.slug }}" class="checkbox">
                      <div class="checkbox-proxy">
                        <svg class="icon-external" width="10" height="10" viewBox="0 0 10 10">
                            <use href="#icon-check"></use>
                        </svg>
                      </div>
                      <span>{{ .Page.Title }}</span>
                    </label>
                </div>
              {{ end }}
            </div>
            <div class="category-filter">
              <h3>Categories</h3>
              {{ range .Site.Taxonomies.categories }}
                <div class="filter-field">
                    <input type="checkbox" id="category-{{ .Page.Params.slug }}" name="category-{{ .Page.Params.slug }}" class="sr-only"/>
                    <label for="category-{{ .Page.Params.slug }}" class="checkbox">
                      <div class="checkbox-proxy">
                        <svg class="icon-external" width="10" height="10" viewBox="0 0 10 10">
                            <use href="#icon-check"></use>
                        </svg>
                      </div>
                      <span>{{ .Page.Title }}</span>
                    </label>
                </div>
              {{ end }}
            </div>
        </div>
        <div class="content">
          <div class="modules-list-items">
            {{ range .Paginator.Pages }}
              <a href="{{ .RelPermalink }}" class="modules-list-item" data-filter='{{ dict "title" .Title "languages" .Params.Languages "categories" .Params.Categories "official" .Params.isOfficial | jsonify }}'>
                {{ partial "img.html" (dict "image" (resources.Get .Params.Logo) "alt" "") }}
                <div class="modules-list-item-content">
                    <div class="title">
                      <h2>{{ .Title }}</h2>
                      {{ if .Params.isOfficial }}
                        <div class="official">Official</div>
                      {{ end }}
                    </div>
                    {{ if .GetTerms "categories" }}
                      <div>
                        {{ range (.GetTerms "categories") }}
                          <div class="category">{{ .Title }}</div>
                        {{ end }}
                      </div>
                    {{ end }}
                    {{ if .GetTerms "languages" }}
                      <ul class="languages">
                        {{ range (.GetTerms "languages") }}
                            <li class="language">{{ .Title }}</li>
                        {{ end }}
                      </ul>
                    {{ end }}
                </div>
              </a>
            {{ end }}
          </div>
          <div class="modules-filter-empty">
            No search results
          </div>
        </div>
      </div>
    </section>
  </main>
{{ end }}